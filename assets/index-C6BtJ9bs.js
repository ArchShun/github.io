var F=Object.defineProperty;var M=(m,n,e)=>n in m?F(m,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):m[n]=e;var h=(m,n,e)=>M(m,typeof n!="symbol"?n+"":n,e);import{R as _,S as I,T as L,U as O,V as R,W as w,X,d as B,s as $,M as p,Y as z,Z as q,_ as D,$ as H,r as W,p as G,c as E,w as U,e as S,x as b,L as Y,g as V,q as Z,F as N,i as C,o as y,a0 as j,a1 as K,a2 as J}from"./vendor-CffigfLb.js";import{l as g}from"./constants-CsdM7RaE.js";import{u as Q,a as ee,b as te,M as oe,S as ie,R as re,_ as ne}from"./components-Dy6Cfxnh.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(o){if(o.ep)return;o.ep=!0;const t=e(o);fetch(o.href,t)}})();const ae={baseStyle:{title:"BaseStyle",background:"Background",color:"Color",image:"Image",imageRepeat:"Image repeat",imagePosition:"Image position",imageSize:"Image size",line:"Line",width:"Width",style:"Style",lineRadius:"Radius",lineOfOutline:"Line of outline",showArrow:"Is show arrow",nodePadding:"Node padding",nodeMargin:"Node margin",horizontal:"Horizontal",vertical:"Vertical",maximumWidth:"Max width",maximumHeight:"Max height",icon:"Icon",size:"Size",level2Node:"Level2 node",belowLevel2Node:"Below level2 node",nodeBorderType:"Node border style",nodeUseLineStyle:"Use only has bottom border style",otherConfig:"Other config",enableFreeDrag:"Enable node free drag(Beta)",openPerformance:"Enable performance mode",watermark:"Watermark",showWatermark:"Is show watermark",onlyExport:"Only export",watermarkDefaultText:"Watermark text",watermarkText:"Watermark text",watermarkTextColor:"Text color",watermarkLineSpacing:"Line spacing",watermarkTextSpacing:"Text spacing",watermarkAngle:"Angle",watermarkTextOpacity:"Text opacity",watermarkTextFontSize:"Font size",belowNode:"Display below nodes",isEnableNodeRichText:"Enable node rich text editing",mousewheelAction:"Mouse wheel behavior",zoomView:"Zoom view",moveViewUpDown:"Move view up and down",associativeLine:"Associative line",associativeLineWidth:"Width",associativeLineColor:"Color",associativeLineActiveWidth:"Active width",associativeLineActiveColor:"Active color",mousewheelZoomActionReverse:"Mouse Wheel Zoom",mousewheelZoomActionReverse1:"Zoom out forward and zoom in back",mousewheelZoomActionReverse2:"Zoom in forward and zoom out back",createNewNodeBehavior:"Behavior of creating new node",default:"Active new node and editing",notActive:"Not active new node",activeOnly:"Only active new node but not editing",rootStyle:"Root Node",associativeLineText:"Associative line text",fontFamily:"Font family",fontSize:"Font size",isShowScrollbar:"Is show scrollbar",isUseHandDrawnLikeStyle:"Is use hand drawn like style",rootLineStartPos:"Root line start pos",center:"Center",edge:"Edge",rainbowLines:"Rainbow lines",notUseRainbowLines:"Not use rainbow lines",outerFramePadding:"Outer frame padding"},color:{moreColor:"More color"},contextmenu:{insertSiblingNode:"Insert sibling node",insertChildNode:"Insert child node",insertParentNode:"Insert parent node",insertSummary:"Insert summary",insertImage:"Insert image",addNote:"Add note",moveUpNode:"Move up node",moveDownNode:"Move down node",moveUpOneLevel:"Move up one level",deleteNode:"Delete node",deleteCurrentNode:"Del cur node",copyNode:"Copy node",cutNode:"Cut node",pasteNode:"Paste node",backCenter:"Back root node",expandAll:"Expand all",unExpandAll:"Un expand all",expandTo:"Expand to",arrangeLayout:"Arrange layout",repairFormula:"Repair formula",level1:"Level1",level2:"Level2",level3:"Level3",level4:"Level4",level5:"Level5",level6:"Level6",zenMode:"Zen mode",fitCanvas:"Fit canvas",removeImage:"Remove image",removeHyperlink:"Remove hyperlink",removeNote:"Remove note",removeCustomStyles:"Remove custom styles",removeAllNodeCustomStyles:"Remove all node custom styles",exportNodeToPng:"Export node to png",copyToClipboard:"Copy to clipboard",copyToSmm:"SMM",copyToJson:"JSON",copyToMarkdown:"Markdown",copyToTxt:"Txt",copyToPng:"Png",copySuccess:"Copy success",copyFail:"Copy fail",number:"Number child nodes"},count:{words:"Words",nodes:"Nodes"},dialog:{cancel:"Cancel",confirm:"Confirm"},export:{title:"Export",filename:"Filename",include:"Is include config like theme and structure",dedicatedFile:"Dedicated file",jsonFile:"json file",imageFile:"Image file",svgFile:"svg file",pdfFile:"pdf file",markdownFile:"markdown file",tips:"tips: .smm and .json file can be import",isTransparent:"Background is transparent",pngTips:"tips: Exporting pictures in rich text mode is time-consuming. It is recommended to export to svg format",svgTips:"tips: Exporting pictures in rich text mode is time-consuming",transformingDomToImages:"Converting nodes: ",notifyTitle:"Info",notifyMessage:"If the download is not triggered, check whether it is blocked by the browser",paddingX:"Padding x",paddingY:"Padding y",useMultiPageExport:"Export multi page",defaultFileName:"Mind map",addFooterTextPlaceholder:"For example: From simple-mind-map",addFooterText:"Add text at the footer"},fullscreen:{fullscreenShow:"Full screen show",fullscreenEdit:"Full screen edit"},demonstrate:{demonstrate:"Enter demonstration mode"},import:{title:"Import",selectFile:"Select file",supportFile:"Support .smm、.json、.xmind、.xlsx、.md file",enableFileTip:"Please select .smm、.json、.xmind、.xlsx、.md file",maxFileNum:"At most one file can be selected",notSelectTip:"Please select the file to import",fileContentError:"The file content is incorrect",importSuccess:"Import success",fileParsingFailed:"File parsing failed",xmindCanvasSelectDialogTitle:"Select the canvas to import"},navigatorToolbar:{openMiniMap:"Open mini map",closeMiniMap:"Close mini map",readonly:"Change to eadonly",edit:"Change to edit",backToRoot:"Back to root node",changeSourceCodeEdit:"Switch to source code editing mode"},nodeHyperlink:{title:"Link",link:"Href",name:"Name"},nodeIcon:{title:"Icon"},nodeImage:{title:"Image",imgTitle:"Title"},nodeNote:{title:"Note"},nodeTag:{title:"Tag",addTip:"Press Enter to add"},outline:{title:"Outline",nodeDefaultText:"Branch node"},scale:{zoomIn:"Zoom in",zoomOut:"Zoom out"},shortcutKey:{title:"Shortcut key"},strusture:{title:"Strusture"},style:{title:"Node style",normal:"Normal",active:"Active",text:"Text",fontFamily:"Font family",fontSize:"Font size",lineHeight:"Line height",color:"color",addFontWeight:"add font weight",italic:"Italic",textDecoration:"Text decoration",underline:"Underline",none:"None",lineThrough:"Line through",overline:"Overline",border:"Border",style:"Style",width:"Width",borderRadius:"Border radius",background:"Background",shape:"Shape",line:"Line",nodePadding:"Node padding",horizontal:"Horizontal",vertical:"Vertical",gradientStyle:"Gradient",startColor:"Start",endColor:"End",arrowDir:"Arrow dir",arrowDirStart:"Start",arrowDirEnd:"End"},theme:{title:"Theme",classics:"Classics",dark:"Darkness",simple:"Simple",coverTip:"You have currently customized the basic style, do you want to overwrite it?",tip:"Tip",cover:"Cover",reserve:"Reserve"},toolbar:{undo:"Undo",redo:"Redo",insertSiblingNode:"Sibling node",insertChildNode:"Child node",deleteNode:"Delete node",image:"Image",icon:"Icon",link:"Link",note:"Note",tag:"Tag",summary:"Summary",displayOutline:"Display outline",baseStyle:"Base style",theme:"Theme",strusture:"Strusture",newFile:"New file",openFile:"Open file",saveAs:"Save as",import:"Import",export:"Export",shortcutKey:"Shortcut key",associativeLine:"Associative line",painter:"Painter",formula:"Formula",attachment:"Attachment",outerFrame:"Outer frame",more:"More",selectFileTip:"Please select a file",notSupportTip:"Your browser does not support this feature, or the current page is not using the HTTPS protocol",tip:"Tip",editingLocalFileTipFront:"Currently editing your local【",editingLocalFileTipEnd:"】file",fileContentError:"File content error",fileOpenFailed:"File open failed",defaultFileName:"Mind map",creatingTip:"Creating file",directory:"Directory",newFileTip:"Please export the currently edited file before creating a new one, Beware of content loss",openFileTip:"Please export the currently edited file before opening it, Beware of content loss"},edit:{newFeatureNoticeTitle:"New feature reminder",newFeatureNoticeMessage:"This update supports node rich text editing, But there are some defects, The most important impact is that the time to export the image is proportional to the number of nodes, Therefore, if you are more dependent on export requirements, you can use【Base style】-【Other config】-【Enable node rich text editing】Set to turn off rich text editing mode.",root:"Root node",splitByWrap:"Is automatically split nodes based on line breaks?",tip:"Tip",yes:"Yes",no:"No",exportError:"Export failed",dragTip:"Release here to import the file"},mouseAction:{tip1:"Current: Left click to drag the canvas, right click to box select nodes",tip2:"Current: Left click to box select nodes, right click to drag the canvas"},search:{searchPlaceholder:"Please enter the search content",replacePlaceholder:"Please enter replacement content",replace:"Replace",replaceAll:"Replace all",cancel:"Cancel",noResult:"No result"},nodeIconSidebar:{title:"Icon/Sticker",icon:"Icon",sticker:"Sticker"},formulaSidebar:{title:"Formula",placeholder:"Please enter LaTeX syntax",confirm:"Confirm",common:"Common formulas",tip:"Inserting formulas is not supported in non rich text mode"},richTextToolbar:{bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",fontFamily:"Font family",fontSize:"Font size",color:"Color",backgroundColor:"Background color",removeFormat:"Clear Style"},other:{loading:"Loading, please wait..."},sourceCodeEdit:{sourceCodeTip:"It is not recommended to modify the style in rich text mode because it requires synchronous modification of data and HTML structure.",format:"Format",copy:"Copy",confirm:"Complete",close:"Close",formatErrorTip:"The JSON format is incorrect. Please check and try again",copyTip:"Copied to clipboard",formatTip:"Format complete"},attachment:{deleteAttachment:"Delete attachment",tip:"The attachment function is only available on the client side"},annotation:{mark:"Mark",show:"Show mark",type:"Type",color:"Color",lineWidth:"Line width",padding:"Padding",animate:"Animate"},nodeOuterFrame:{outerFrameSetting:"Setting",deleteOuterFrame:"Delete outer frame",boxStyle:"Box style",boxColor:"Box color",fillColor:"Fill color"},nodeTagStyle:{placeholder:"Please enter the tag content",delete:"Delete this tag"}},le={baseStyle:{title:"基础样式",background:"背景",color:"颜色",image:"图片",imageRepeat:"图片重复",imagePosition:"图片位置",imageSize:"图片大小",line:"连线",width:"粗细",style:"风格",lineRadius:"圆角大小",lineOfOutline:"概要的连线",showArrow:"是否显示箭头",nodePadding:"节点内边距",nodeMargin:"节点外边距",horizontal:"水平",vertical:"垂直",maximumWidth:"显示的最大宽度",maximumHeight:"显示的最大高度",icon:"图标",size:"大小",level2Node:"二级节点",belowLevel2Node:"三级及以下节点",nodeBorderType:"节点边框风格",nodeUseLineStyle:"是否使用只有底边框的风格",otherConfig:"其他配置",enableFreeDrag:"是否开启节点自由拖拽",openPerformance:"开启性能模式(Beta)",watermark:"水印",showWatermark:"是否显示水印",watermarkDefaultText:"水印文字",onlyExport:"是否仅在导出时显示",watermarkText:"水印文字",watermarkTextColor:"文字颜色",watermarkLineSpacing:"水印行间距",watermarkTextSpacing:"水印文字间距",watermarkAngle:"旋转角度",watermarkTextOpacity:"文字透明度",watermarkTextFontSize:"文字字号",belowNode:"显示在节点下方",isEnableNodeRichText:"是否开启节点富文本编辑",mousewheelAction:"鼠标滚轮行为",zoomView:"缩放视图",moveViewUpDown:"上下移动视图",associativeLine:"关联线",associativeLineWidth:"粗细",associativeLineColor:"颜色",associativeLineActiveWidth:"激活粗细",associativeLineActiveColor:"激活颜色",mousewheelZoomActionReverse:"鼠标滚轮缩放",mousewheelZoomActionReverse1:"向前缩小向后放大",mousewheelZoomActionReverse2:"向前放大向后缩小",createNewNodeBehavior:"创建新节点的行为",default:"激活新节点及进入编辑",notActive:"不激活新节点",activeOnly:"只激活新节点，不进入编辑",rootStyle:"根节点",associativeLineText:"关联线文字",fontFamily:"字体",fontSize:"字号",isShowScrollbar:"是否显示滚动条",isUseHandDrawnLikeStyle:"是否开启手绘风格",rootLineStartPos:"根节点连线起始位置",center:"中心",edge:"边缘",rainbowLines:"彩虹线条",notUseRainbowLines:"不使用彩虹线条",outerFramePadding:"外框内边距"},color:{moreColor:"更多颜色"},contextmenu:{insertSiblingNode:"插入同级节点",insertChildNode:"插入子级节点",insertParentNode:"插入父节点",insertSummary:"插入概要",insertImage:"插入图片",addNote:"添加备注",moveUpNode:"上移节点",moveDownNode:"下移节点",moveUpOneLevel:"上移一级",deleteNode:"删除节点",deleteCurrentNode:"删除当前",copyNode:"复制节点",cutNode:"剪切节点",pasteNode:"粘贴节点",backCenter:"回到根节点",expandAll:"展开所有",unExpandAll:"收起所有",expandTo:"展开到",arrangeLayout:"一键整理布局",repairFormula:"修复公式格式",level1:"一级主题",level2:"二级主题",level3:"三级主题",level4:"四级主题",level5:"五级主题",level6:"六级主题",zenMode:"禅模式",fitCanvas:"适应画布",removeImage:"移除图片",removeHyperlink:"移除超链接",removeNote:"移除备注",removeCustomStyles:"一键去除自定义样式",removeAllNodeCustomStyles:"一键去除所有节点自定义样式",exportNodeToPng:"导出该节点为图片",copyToClipboard:"复制到剪贴板",copyToSmm:"SMM",copyToJson:"JSON",copyToMarkdown:"Markdown",copyToTxt:"Txt",copyToPng:"图片",copySuccess:"复制成功",copyFail:"复制失败",number:"编号其子节点"},count:{words:"字数",nodes:"节点"},dialog:{cancel:"取 消",confirm:"确 定"},export:{title:"导出",filename:"导出文件名称",include:"是否包含主题、结构等配置数据",dedicatedFile:"专有文件",jsonFile:"json文件",imageFile:"图片文件",svgFile:"svg文件",pdfFile:"pdf文件",markdownFile:"markdown文件",tips:"tips：.smm和.json文件可用于导入",isTransparent:"背景是否透明",pngTips:"tips：富文本模式导出图片非常耗时，建议导出为svg格式",svgTips:"tips：富文本模式导出图片非常耗时",transformingDomToImages:"正在转换节点：",notifyTitle:"消息",notifyMessage:"如果没有触发下载，请检查是否被浏览器拦截了",paddingX:"水平内边距",paddingY:"垂直内边距",useMultiPageExport:"是否多页导出",defaultFileName:"思维导图",addFooterText:"底部添加文字",addFooterTextPlaceholder:"比如：来自simple-mind-map"},fullscreen:{fullscreenShow:"全屏查看",fullscreenEdit:"全屏编辑"},demonstrate:{demonstrate:"进入演示模式"},import:{title:"导入",selectFile:"选取文件",supportFile:"支持.smm、.json、.xmind、.xlsx、.md文件",enableFileTip:"请选择.smm、.json、.xmind、.xlsx、.md文件",maxFileNum:"最多只能选择一个文件",notSelectTip:"请选择要导入的文件",fileContentError:"文件内容有误",importSuccess:"导入成功",fileParsingFailed:"文件解析失败",xmindCanvasSelectDialogTitle:"选择要导入的画布"},navigatorToolbar:{openMiniMap:"开启小地图",closeMiniMap:"关闭小地图",readonly:"切换为只读模式",edit:"切换为编辑模式",backToRoot:"回到根节点",changeSourceCodeEdit:"切换为源码编辑模式"},nodeHyperlink:{title:"超链接",link:"链接",name:"名称"},nodeIcon:{title:"图标"},nodeImage:{title:"图片",imgTitle:"图片标题"},nodeNote:{title:"备注"},nodeTag:{title:"标签",addTip:"请按回车键添加"},outline:{title:"大纲",nodeDefaultText:"分支节点"},scale:{zoomIn:"放大",zoomOut:"缩小"},shortcutKey:{title:"快捷键"},strusture:{title:"结构"},style:{title:"节点样式",normal:"常态",active:"选中状态",text:"文字",fontFamily:"字体",fontSize:"字号",lineHeight:"行高",color:"颜色",addFontWeight:"加粗",italic:"斜体",textDecoration:"划线",none:"无",underline:"下划线",lineThrough:"中划线",overline:"上划线",border:"边框",style:"样式",width:"宽度",borderRadius:"圆角",background:"背景",shape:"形状",line:"线条",nodePadding:"节点内边距",horizontal:"水平",vertical:"垂直",gradientStyle:"渐变",startColor:"起始",endColor:"结束",arrowDir:"箭头位置",arrowDirStart:"头部",arrowDirEnd:"尾部"},theme:{title:"主题",classics:"经典",dark:"深色",simple:"朴素",coverTip:"你当前自定义过基础样式，是否覆盖？",tip:"提示",cover:"覆盖",reserve:"保留"},toolbar:{undo:"回退",redo:"前进",insertSiblingNode:"同级节点",insertChildNode:"子节点",deleteNode:"删除节点",image:"图片",icon:"图标",link:"超链接",note:"备注",tag:"标签",summary:"概要",displayOutline:"显示大纲",baseStyle:"基础样式",theme:"主题",strusture:"结构",newFile:"新建",openFile:"打开",saveAs:"另存为",import:"导入",export:"导出",shortcutKey:"快捷键",associativeLine:"关联线",painter:"格式刷",formula:"公式",attachment:"附件",outerFrame:"外框",more:"更多",selectFileTip:"请选择文件",notSupportTip:"你的浏览器不支持该功能，或者当前页面非https协议",tip:"提示",editingLocalFileTipFront:"当前正在编辑你本机的【",editingLocalFileTipEnd:"】文件",fileContentError:"文件内容有误",fileOpenFailed:"文件打开失败",defaultFileName:"思维导图",creatingTip:"正在创建文件",directory:"目录",newFileTip:"新建文件前请先导出当前编辑的文件，谨防内容丢失",openFileTip:"打开文件前请先导出当前编辑的文件，谨防内容丢失"},edit:{newFeatureNoticeTitle:"新特性提醒",newFeatureNoticeMessage:"本次更新支持了节点富文本编辑，但是存在一定缺陷，最主要的影响是导出为图片的时间和节点数量成正比，所以对导出需求比较依赖的话可以通过【基础样式】-【其他配置】-【是否开启节点富文本编辑】设置关掉富文本编辑模式。",root:"根节点",splitByWrap:"是否按换行自动分割节点？",tip:"提示",yes:"是",no:"否",exportError:"导出失败",dragTip:"在此释放以导入该文件"},mouseAction:{tip1:"当前：左键拖动画布，右键框选节点",tip2:"当前：左键框选节点，右键拖动画布"},search:{searchPlaceholder:"请输入查找内容",replacePlaceholder:"请输入替换内容",replace:"替换",replaceAll:"全部替换",cancel:"取消",noResult:"暂无结果"},nodeIconSidebar:{title:"图标/贴纸",icon:"图标",sticker:"贴纸"},formulaSidebar:{title:"公式",placeholder:"请输入 LaTeX 语法",confirm:"完成",common:"常用公式",tip:"非富文本模式下不支持插入公式"},richTextToolbar:{bold:"加粗",italic:"斜体",underline:"下划线",strike:"删除线",fontFamily:"字体",fontSize:"字号",color:"字体颜色",backgroundColor:"背景颜色",removeFormat:"清除样式"},other:{loading:"正在加载，请稍后..."},sourceCodeEdit:{sourceCodeTip:"富文本模式下不建议修改样式，因为需要同步修改数据及html结构。",format:"格式化",copy:"复制",confirm:"完成",close:"关闭",formatErrorTip:"JSON格式有误，请检查后再试",copyTip:"已复制到剪贴板",formatTip:"格式化完成"},attachment:{deleteAttachment:"删除附件",tip:"附件功能仅在客户端可用"},annotation:{mark:"标记",show:"显示标记",type:"类型",color:"颜色",lineWidth:"线宽",padding:"内边距",animate:"开启动画"},nodeOuterFrame:{outerFrameSetting:"外框设置",deleteOuterFrame:"删除外框",boxStyle:"边框样式",boxColor:"边框颜色",fillColor:"填充颜色"},nodeTagStyle:{placeholder:"请输入标签内容",delete:"删除此标签"}},se={zh:le,en:ae},de=_({locale:"zh",fallbackLocale:"en",messages:se,legacy:!1});function k(m,n={}){const e=document.createElement(m),i=n.attributes??{};for(const o in i)e.setAttribute(o,i[o]);for(const o of n.classNames??[])e.classList.add(o);return e.innerHTML=n.innerHTML??"",e}const s={LATEX_PANEL:".latex-auto-panel",LATEX_PANEL_CATEGORY:".latex-auto-panel-category",LATEX_PANEL_LST:".latex-auto-panel-lst"};class T extends I{constructor(e){super(e);h(this,"latexAuto",{show:!1,focusLeft:!1,word:""});h(this,"latexItems",new Map);h(this,"latexCategory",new Map);h(this,"showGroup",document.createElement("ul"));this.initLatexAutoPanelOptItems()}initLatexAutoPanelOptItems(){var o;let e=0;for(const t in g){const a=g[t].items.map((l,d)=>({id:e+d,...l,category:t,node:null})).map(l=>({...l,node:this.createListItem(l)})).toSorted((l,d)=>(l.sort??0)-(d.sort??0)),r=document.createElement("li");r.setAttribute("data-value",t),r.innerHTML=`<span>${g[t].title}</span>`,this.latexCategory.set(t,{...g[t],items:a,node:r}),e+=g[t].items.length,this.latexCategory.get(t).items.forEach(l=>this.latexItems.set(l.id,l))}const i=this.latexCategory.get("All");i.items.push(...this.latexItems.values()),(o=i.node)==null||o.classList.add("active")}initQuillEditor(){super.initQuillEditor(),this.quill.on("text-change",e=>{var i,o,t,a,r,l,d;if(((i=e==null?void 0:e.ops)==null?void 0:i.length)>1)if(((t=(o=e==null?void 0:e.ops)==null?void 0:o[1])==null?void 0:t.delete)>0&&this.latexAuto.word.length>0)this.latexAuto.word=this.latexAuto.word.slice(0,-((r=(a=e==null?void 0:e.ops)==null?void 0:a[1])==null?void 0:r.delete));else if(typeof((d=(l=e==null?void 0:e.ops)==null?void 0:l[1])==null?void 0:d.insert)=="string"){const c=e.ops[1].insert.trim();c===""?this.latexAuto.word="":c==="\\"?this.latexAuto.word="\\":this.latexAuto.word.length>0&&(this.latexAuto.word+=c)}else this.latexAuto.word="";this.setLatexAutoPanelContent()}),this.quill.keyboard.addBinding({key:[38,40]},(e,{event:{code:i}})=>{var r,l,d,c,A,v;if(this.latexAuto.show===!1)return!0;const o=this.getLatexAutoPanel();let t=null;if(this.latexAuto.focusLeft?t=o.querySelector(s.LATEX_PANEL_CATEGORY):t=this.showGroup,t==null)throw new Error("subDiv not found");const a=t==null?void 0:t.querySelector("li.active");if(a==null)(r=t==null?void 0:t.querySelector("li:not(.hidden)"))==null||r.classList.add("active");else{if(i==="ArrowUp"){let u=a.previousElementSibling;for(;u&&u.classList.contains("hidden");)u=u.previousElementSibling;if(u==null){const x=(t==null?void 0:t.querySelectorAll("li:not(.hidden)"))??[];x.length>0&&(u=x[x.length-1])}u==null||u.classList.add("active")}else{const u=(l=a.parentElement)==null?void 0:l.querySelector("li.active ~ li:not(.hidden)");u?u.classList.add("active"):(d=t==null?void 0:t.querySelector("li:not(.hidden)"))==null||d.classList.add("active")}a.classList.remove("active")}(c=t==null?void 0:t.querySelector("li.active"))==null||c.scrollIntoView({block:"nearest",inline:"nearest"}),this.latexAuto.focusLeft&&((v=(A=this.latexCategory.get(this.currentCategory))==null?void 0:A.node)==null||v.classList.remove("focus"),this.setLatexAutoPanelContent())}),this.quill.keyboard.addBinding({key:[37,39]},(e,{event:{code:i}})=>{var o,t;if(this.latexAuto.show===!1)return!0;if(i==="ArrowRight"&&this.latexAuto.focusLeft||i==="ArrowLeft"&&!this.latexAuto.focusLeft){const a=this.getLatexAutoPanel();this.latexAuto.focusLeft=i==="ArrowLeft",(o=a.querySelector(this.latexAuto.focusLeft?s.LATEX_PANEL_LST:s.LATEX_PANEL_CATEGORY))==null||o.classList.remove("focus"),(t=a.querySelector(this.latexAuto.focusLeft?s.LATEX_PANEL_CATEGORY:s.LATEX_PANEL_LST))==null||t.classList.add("focus")}}),this.quill.keyboard.addBinding({key:27},()=>{if(this.latexAuto.show===!1)return!0;this.hideLatexAutoPanel()}),this.quill.keyboard.addBinding({key:32},e=>{var l;if(this.latexAuto.show===!1)return!0;const i=(l=this.latexCategory.get(this.currentCategory))==null?void 0:l.items.find(d=>{var c;return(c=d.node)==null?void 0:c.classList.contains("active")});if(i==null)return console.error("not found active item");i.sort=(i.sort??0)+1;const o=i.cmd,t=this.latexAuto.word,a=e.index-t.length;this.quill.deleteText(a,t.length),this.quill.insertText(a,o,"api");const r=i.pos?i.pos-1:o.search(new RegExp("(?<=\\{.*?)\\s+?(?=.*?\\})|\\{\\}","g"));r>-1&&this.quill.setSelection(a+r+1),this.hideLatexAutoPanel()}),this.quill.keyboard.addBinding({key:"$",shiftKey:!0},e=>{e.length>0&&this.quill.deleteText(e.index,e.length),this.quill.insertText(e.index,"$$","api"),this.quill.setSelection(e.index+1)})}appendCss(){super.appendCss();const e=`          
            ${s.LATEX_PANEL}{
                display:flex;
                flex-direction:row;
                position:fixed;
                margin-top:10px;
                color:grey;
                border-radius:5px;
                box-shadow: rgba(0, 0, 0, 0.2) 4px 4px 4px 1px;
                background:white;
            }
            ${s.LATEX_PANEL} .hidden,${s.LATEX_PANEL}.hidden{
                display:none !important;
            }
            ${s.LATEX_PANEL} ul{
                width:100%;
                padding:0;
                margin:0;
            }
            ${s.LATEX_PANEL} ul li{
                height:36px;
            }
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_LST},
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_CATEGORY}{
                overflow-y:auto;
                scrollbar-width: none;
                min-width:180px;
                max-height:220px;
            }
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_CATEGORY}{
                float:left;
                display:flex;
                background:#e2ffff;
                min-width:120px;
            }
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_LST}::-webkit-scrollbar{
                display: none;
            }
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_LST} li,
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_CATEGORY} li {
                display: flex;
                justify-content: space-between;
                padding: 6px 12px;
                padding-left: 16px;
                list-style-type:none;
            }
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_CATEGORY} span{
                margin:auto;
            }
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_LST} li.active,
            ${s.LATEX_PANEL} ${s.LATEX_PANEL_CATEGORY} li.active{
                background:#85dbdb;
                font-weight: bold;
                color:white;
            }
            ${s.LATEX_PANEL} .focus .active{
                background:lightcoral !important;
            }
            ${s.LATEX_PANEL} .icon svg{
                width:100%;
                height:100%;
            }
        `;this.styleEl=document.createElement("style"),this.styleEl.type="text/css",this.styleEl.innerHTML=e,document.head.appendChild(this.styleEl)}get currentCategory(){var e;return((e=this.getLatexAutoPanel().querySelector(`${s.LATEX_PANEL_CATEGORY} li.active`))==null?void 0:e.getAttribute("data-value"))??"All"}hideLatexAutoPanel(){var e;(e=document.querySelector(s.LATEX_PANEL))==null||e.classList.add("hidden"),this.latexAuto.word="",this.latexAuto.show=!1,this.showGroup.innerHTML=""}renderLatexAutoPanel(){var e,i,o;this.latexAuto.show=!0,this.getLatexAutoPanel().classList.remove("hidden"),(o=(i=(e=this.latexCategory.get(this.currentCategory))==null?void 0:e.items.find(t=>{var a;return(a=t.node)==null?void 0:a.classList.contains("active")}))==null?void 0:i.node)==null||o.scrollIntoView({block:"nearest",inline:"nearest"})}setLatexAutoPanelContent(){if(this.latexAuto.word.length<1)return this.hideLatexAutoPanel();const e=this.latexAuto.word.substring(1).toLocaleLowerCase();for(const r of Array.from(this.showGroup.children))r.classList.remove("active");this.showGroup.innerHTML="";const i=this.latexCategory.get(this.currentCategory).items,o=[],t=[];for(const r of i)r.cmd.toLocaleLowerCase().startsWith("\\"+e)||r.tag.toLocaleLowerCase().startsWith(e)?o.push(r):(r.tag.toLocaleLowerCase().indexOf(e)>-1||r.cmd.toLocaleLowerCase().indexOf(e)>-1)&&t.push(r);const a=[...o.sort((r,l)=>(l.sort??0)-(r.sort??0)),...t.sort((r,l)=>(l.sort??0)-(r.sort??0))];a.forEach(r=>{var l;(l=r.node)==null||l.classList.remove("active"),this.showGroup.appendChild(r.node)}),a[0].node.classList.add("active"),this.renderLatexAutoPanel()}createListItem(e){const i=k("li",{attributes:{"data-id":`${e.id}`,"data-value":e.tag},innerHTML:`<span>${e.tag}</span>`}),o=k("span",{classNames:["icon"]});return e.icon&&e.icon.startsWith("<svg")?o.innerHTML=e.icon:e.example?L.render(e.example,o,{displayMode:!0}):e.icon&&(o.innerHTML=e.icon),i.appendChild(o),i}getLatexAutoPanel(){var r,l;let e=document.querySelector(s.LATEX_PANEL);if(e!==null)return e;e=document.createElement("div"),e.classList.add("hidden",s.LATEX_PANEL.substring(1));const i=`
            <div class="${s.LATEX_PANEL_CATEGORY.substring(1)} ${this.latexAuto.focusLeft?"focus":""}">
                <ul style="padding:0;margin:0;">
                    ${[...this.latexCategory.entries()].map(([,d])=>{var c;return((c=d.node)==null?void 0:c.outerHTML)??""}).join("")}
                </ul>
            </div>
        `,o=`<div class="${s.LATEX_PANEL_LST.substring(1)} ${this.latexAuto.focusLeft?"":"focus"}"></div>`;e.innerHTML=i+o,(l=(r=document==null?void 0:document.querySelector(".ql-editor"))==null?void 0:r.parentNode)==null||l.appendChild(e);const t=e.querySelector(s.LATEX_PANEL_LST);t==null||t.appendChild(this.showGroup);const a=document.createElement("ul");return a.classList.add("hidden","hidden-group"),t.appendChild(a),e}}T.instanceName="richText";class P extends O{constructor(n){super(n)}getStyleText(){let n=super.getStyleText();return n+=`
            .katex,.katex-display,.katex-html{
                display: inline-block !important; 
                position: relative;
                font-size: 1em !important;
            }
            .katex-display{
                margin: .1em !important;
            }
            .katex math{
                display: inline-block !important; 
            }
        `,n}getKatexConfig(){const n={throwOnError:!1,errorColor:"#f00",output:"htmlAndMathml",displayMode:!0},e=R();return e&&e<=100&&(n.output="html"),n}extendQuill(){const n=w.import("formats/formula"),e=this;class i extends n{static create(t){var r,l;const a=super.create(t);return typeof t=="string"&&(L.render(t,a,e.config),a.setAttribute("data-value",((l=(r=t.replaceAll("&","&amp;"))==null?void 0:r.replaceAll("<","&lt;"))==null?void 0:l.replaceAll(">","&gt;"))??"")),a}}w.register("formats/formula",i,!0)}latexRichToText(n){if(n.indexOf('class="ql-formula"')!==-1){const o=new DOMParser().parseFromString(n,"text/html").getElementsByClassName("ql-formula");for(const t of Array.from(o))n=n.replace(t.outerHTML,`$${t.getAttribute("data-value")}$`)}return n}checkFormulaIsLegal(n){try{return L.renderToString(n,this.config),!0}catch{return!1}}repairFormula(){const n=new DOMParser;X(this.mindMap.renderer.renderTree,e=>{var i,o,t;if((i=e==null?void 0:e.data)!=null&&i.richText&&e.data.text){const a=n.parseFromString(e.data.text,"text/html"),r=a.getElementsByClassName("ql-formula");for(const l of Array.from(r))l.hasAttribute("data-value")&&l.setAttribute("data-value",((t=(o=l.getAttribute("data-value"))==null?void 0:o.replaceAll("<","&lt;"))==null?void 0:t.replaceAll(">","&gt;"))??"");e.data.text=a.body.innerHTML}})}}P.instanceName="formula";const ce={class:"loading"},ue={id:"mindMapContainer"},me=B({__name:"App",setup(m){const{loading:n}=$(Q()),e=ee(),i=te();T.instanceName="richText",p.usePlugin(T),p.usePlugin(P),p.usePlugin(z),p.usePlugin(q),p.usePlugin(D),p.usePlugin(H);const o=W(!1);return G(()=>{const t=new p({el:document.getElementById("mindMapContainer"),data:{data:{text:"根节点"},children:[]}});o.value=!0,e.setMindMap(t),new ResizeObserver(r=>{for(let l of r){const d=document.querySelector("#mindMapContainer > svg");d&&(d.style.width=l.contentRect.width+"px",d.style.height=l.contentRect.height+"px"),t.resize()}}).observe(document.getElementById("mindMapContainer")),i.init()}),(t,a)=>{const r=Y("loading");return y(),E(N,null,[U(S("div",ce,null,512),[[r,V(n)]]),S("div",ue,[o.value?(y(),Z(re,{key:0})):b("",!0)]),o.value?(y(),E(N,{key:0},[C(oe),C(ie)],64)):b("",!0)],64)}}}),pe=ne(me,[["__scopeId","data-v-cd237262"]]);document.title="Mind Map Math Online";const f=j(pe);f.use(K());f.use(J);f.use(de);f.mount("#app");
//# sourceMappingURL=index-C6BtJ9bs.js.map
